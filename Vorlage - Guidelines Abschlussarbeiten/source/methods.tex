%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vorlage für Abschlussarbeiten                                     %%
%%-------------------------------------------------------------------%%
%% Datei:        methods.tex                                         %%
%% Beschreibung: Methodenteil, der beschreibt welche Hard- oder      %%
%%               Software bereits vorhanden ist.                     %%
%%               und ein Ausblick KURZ auf ca einer bis max zwei     %%
%%               Seiten zusammengefasst.                             %%
%% Autor: 			 Stefan Herrmann                                     %%
%% Datum:        28.11.2012                                          %%
%% Version:      1.1.0                                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Systemaufbau}
\index{Systemaufbau} %% Eintrag im Stichwortverzeichnis
Der Aufbau, des gesamten Systems, lässt sich in den Hardwareanteil und den Softwareanteil aufgliedern. Zuerst wird auf die verschiedenen Pakete und Treiber, die den Softwareanteil ausmachen, eingegangen und deren Zusammenspiel im Gesamtsoftwarekonzept erläutert. Im zweiten Teil des Kapitels werden die Hardwarekomponenten des Systems vorgestellt. Hier wird als erstes die Aufgabe jeder relevanten Komponente beschrieben, um diese dann verständlich in einen Kontext bringen zu können. Am Ende dieses Kapitels werden der Softwareanteil und der Hardwareanteil, im Gesamtkonzept, zu einer verständlichen Darstellung des Systems zusammengefügt.

\section{Software}
\index{Software}
In diesem Abschnitt wird die in dem Entwicklungsprozess verwendete und eingebundene Software vorgestellt. Dies soll einen ersten Überblick über den Entwicklungsprozess geben und das Softwarekonzept des Systems verständlich darstellen. Die Installation und die genauere Verwendung, der hier genannten Software, ist integraler Teil des vierten Kapitels und wird somit hier nicht behandelt.

\subsection{Betriebsysteme}
Auf dem zur Entwicklung genutzten Rechner ist WINDOWS 10 als Betriebssystem installiert. Da ROS ein Framework für Linuxdistributionen ist, ist es notwendig ein Linux-Betriebssystem in einer virtuellen Maschine zu betreiben. Hierfür wird eine virtuelle Maschine von ''VM-Ware' verwendet. 'In der virtuellen Maschine wird ein Ubuntu in der Version 16.04 LTS, welches in der WE4 laufend gepflegt und erweitert wird, betrieben. Unter dieser Ubuntu Version der WE4 ist das ROS-Framework, in der Version '''Kinetic Kame'', bereits installiert.
Bei der virtuellen Maschine von ''VM-Ware'' ist darauf zu achten, dass der USB-Kompatibilitätsmodus  auf ''USB 3.0'' gesetzt ist, da sonnst Probleme mit USB-Geräten auftreten können.

\subsection{Integrierte Entwicklungsumgebungen}
Für die Entwicklung von Software reicht in der Regel ein Texteditor und ein Compiler aus. Um diese Entwicklung komfortabler und übersichtlicher zu gestalten werden integrierte Entwicklungsumgebungen verwendet. Hier sind normalerweise Texteditor, Compiler, Linker und weitere Programme in einer Anwendung integriert, um ein ständiges wechseln zwischen den Programmen zu vermeiden.

\subsection*{Eclipse}
Um Programme in der der Programmiersprache C/C++ zu entwickeln, wurde die integrierte Entwicklungsumgebung ''Eclipse''\cite{ECLIPSE} verwendet. Die verwendete Installation von ''Eclipse'' wurde innerhalb der WE4 mit dem ''Ubuntu'' Betriebssystem zusammen gepflegt. Weiterhin waren keine Anpassungen, der Konfiguration von ''Eclipse'', nötig um Programme für das ROS-Framework darin zu entwickeln.

\subsection*{Keil}
Die integrierte Entwicklungsumgebung ''$\mu$-vision'' von ''KEIL'' wurde verwendet, um ggf. Änderungen an der Software, die auf dem Mikrocontrollerboard  läuft, vorzunehmen.\cite{KEIL}
Auf das genannte Mikrocontrollerboard wird im Hardwareteil des Kapitels eingegangen.

\subsection{Robot Operating System}
Das ''Robot Operating System'' ist ein Quelloffenes und flexibles Framework, das darauf abzielt die Entwicklung von Software, für Robotersysteme, zu vereinfachen. Dazu stellt dieses Framework eine Sammlung von Tools, Bibliotheken und anderer Software zur verfügung.\cite{ROS, KOUBAA2016} Unter ROS werden zur Entwicklung von Software die Programmiersprachen C/C++ und Python verwendet. Um die Konsistenz zu anderer Software die in der WE4 verwendet wird zu wahren, wurde für die im Zuge dieser Bachelorarbeit entwickelte Software die Programmiersprache C/C++ gewählt.
Auf den Aufbau und die Funktionen von ROS, wird im Grundlagenkapitel noch näher eingegangen.

\subsection*{Rviz}
 Die Anwendung ''Rviz'' ist ein 3D-Visulaisierungstool unter ROS. Diese wird unter anderem für die Simulation von Robotern genutzt. Weiterhin wird mit ''Rviz'' visualisiert was die Sensoren ''sehen'' und die Aktoren ''tun''.\cite{Rviz}

\subsection{OpenNI}
Um auf 3D-Sensoren wie Stereokameras zugreifen zu können, wurde unter ''Ubuntu'' das quelloffene Framework ''OpenNI'' verwendet. Es bietet API's um für 3D-Sensoren, RGB-Kameras, IR-Kameras und Audioeingabegeräte Anwendungen zu entwickeln.\cite{OPENNI} Im Zuge dieser Bachelorarbeit wurde hier die Möglichkeit von ''OpenNI''genutzt unkompliziert Treiber, für die genannten Gerätetypen, einzubinden. Weiterhin ist dieses Framework notwendig, um Software die auf diesem basiert ausführen zu können. Dieses Framework ist als erster Baustein in dem Gesamtsoftwarekonzept des Systems zu sehen.

\subsection{SensorKinect}
Das Paket ''SensorKinect'' ist ein Modul für das Framework ''OpenNI''. Dieses Modul ermöglicht den Zugriff auf die Stereokamera ''Kinect'' von ''Microsoft'', über die API's von ''OpenNI''. \cite{SENSORKINECT}
Somit dient ''SensorKinect'' als Hardwaretreiber für die Stereokamera ''Kinect''. Als Modul fügt sich ''SensorKinect'' in den Baustein ''OpenNI'' des Gesamtsoftwarekozeptes ein. Wird ein zum Treiber von ''PrimeSense'' kompatibler Sensor genutzt, ist die Installation von ''SensorKinect'' nicht erforderlich.\cite{OPENNI}

\subsection{Ros-Kinetic-OpenNI}
Um die Funktionen des Framework ''OpenNI'' auch in Verbindung mit ROS verwenden zu können, werden zusätzlich mehrere ROS-Pakete, die im weiteren unter dem Namen''Ros-Kinetic-OpenNI'' gefasst werden sollen, benötigt.

\subsection{NITE} 
Das Paket ''NITE'' ist eine Middleware, die sich in die Infrastruktur des Framework ''OpenNI'' mit eingliedert. Diese Middleware erweitert die Funktionen von ''OpenNI'' unter anderem um das Tracking von Handbewegungen und Körperbewegungen im ganzen.\cite{NITE,OPENNI}

\subsection{OpenNI Tracker}
Das ROS-Paket ''OpenNI Tracker'' greift auf die durch ''NITE'' implementierten Funktionen zu, um die Positionen von Körpergelenken zu bestimmen und diese in ROS zur Verfügung zu stellen.\cite{OPENNITRACKER}

\subsection{MoveIt!}
Mit ''MoveIt'' wurde ein weiteres Framework unter ROS genutzt. Das Framework ''MoveIt'' ist die ''State-Of-The-Art-Software'' für Navigationsplanung und Manipulationsplanung in der Robotik unter ROS.\cite{MOVEIT,KOUBAA2016}
Dieses Framework war notwendig, da basierend auf der zu implementierenden Gestenerkennung eine Gestensteuerung für einen Roboterarm entwickelt wurde.

\subsection{Turtle Simulator}
Der ''Turtle Simulator'' ist eine Anwendung in der Schildkröten auf einem 2D-Spielfeld gesteuert werden können. In der ROS-Community wird der ''Turtle Simulator'' für Tutorials, unteranderem zum erlenen des Umganges mit den TF-Paketen, genutzt.\cite{TURTLESIM}



\subsection{Softwarekonzept}
In diesem Abschnitt wird das Softwarekonzept des Gesamtsystems dargestellt und erklärt. In der Abbildung \ref{fig:Softwarearchitektur}  ist die Softwarearchitektur des Gestenerkennungssystems, mit Anteilen der Steuerung eines Roboterarmes, zu sehen. Die Softwarearchitektur lässt sich in drei Schichten aufteilen. Die ROS-Schicht in der Mitte bildet die Basis und stellt die Umgebung zur Verfügung, in der die Anwendungen laufen werden, welche die Gestenerkennung nutzen. Zu der Gestenerkennungsschicht gehören die Bausteine''OpenNI'', ''OpenNI Tracker'' und ''Ros-Kinetic-OpenNI''. In der Abbildung \ref{fig:ALVOPENNI}, einer ''Abstract Layered View'', ist der schematische Aufbau des Bausteins ''OpenNI'' zu sehen. Wie zu sehen ist, fügen sich die Module ''SensorKinect'' und ''NITE'' in diesen ein und werden im Weiteren nicht mehr eigenständig behandelt. Die Hardwareschicht setzt sich aus den Bausteinen ''MoveIt!'' und ''Robot\_hardware\_interface'' zusammen. Unter dem Baustein ''Robot\_hardware\_interface'' sind alle Bestandteile, die zur Kommunikation von''MoveIt!'' bis zum Roboterarm ''rob\_arm\_small'' und zur Steuerung des Roboterarmes dienen, zusammengefasst. Auf die Anteile der Hardwareschicht und den Roboterarm ''rob\_arm\_small'' wird im Hardwareteil dieses Kapitels sowie im Grundlagenkapitel näher eingegangen. Mit dem Baustein Rviz können 3D-Punktwolken, basierend auf den von ''Ros-Kinetic-OpenNI'' bereitgestellten Daten, dargestellt werden. Parallel zur Punktwolke kann das von''OpenNI Tracker'' erkannte Skelett über TF's visualisiert werden. Der Baustein''dashboard-GUI'' bietet die Möglichkeit unkompliziert GUI's zu erstellen. Dies ist z.B. für das einfache und übersichtliche Debugging von Software und Hardware interessant. Die Abbildung \ref{fig:Softwarekonzept} zeigt das Softwarekonzept des Gesamtsystems. Den äußeren Rahmen bildet hier das Hostbetriebssystem ''Windows 10''. Auf diesem Hostbetriebssystem läuft im ''VmWare Player'', einer virtuellen Maschine, ein ''Ubuntu'' der Version 16.04 LTS. Unter diesem Betriebssystem fügt sich dann die Softwarearchitektur des Gestenerkennungssystems ein.

\begin{figure}
	\centering
		\includegraphics[width=0.7\textwidth]{images/methods/Softwarearchitektur.png}
	\caption{Softwarearchitektur}
	\label{fig:Softwarearchitektur}
\end{figure}
\begin{figure}
	\centering
		\includegraphics[width=0.6\textwidth]{images/methods/AbstractLayeredViewOpenNI.png}
	\caption{Abstract Layered View - OpenNI}
	\label{fig:ALVOPENNI}
\end{figure}
\begin{figure}
	\centering
		\includegraphics[width=0.6\textwidth]{images/methods/SoftwarekonzeptFull.png}
	\caption{Softwarekonzept}
	\label{fig:Softwarekonzept}
\end{figure}

\section{Hardware}
\index{Hardware}
In diesem Abschnitt wird die Hardware des Gesamtsystems kurz vorgestellt. Auf die Funktionsweise und die Grundlagen zu elementarer Hardware , wird erst im Grundlagenkapitel näher eingegangen.

\subsection{Rechner}
Der verwendete Rechner hatte folgende Systemspezifikation:
\begin{description}
\item[Prozessor:] xyz
\item[Speicher:] zzz
\item[Grafikkarte:] uuu
\end{description}

Bei dem verwendeten Rechner ist darauf zu achten, dass der Prozessor die Befehlssätze SSE3, SSE4 und SSSE3 unterstützt. Bei nicht unterstützen der genannten Befehlssätze, können Fehler zur Laufzeit der verwendeten Software auftreten. Weiterhin ist darauf zu achten das mindestens ein vollwertiger USB 3.X Port belegbar ist.

\subsection{Kinect}


In diesem Kapitel wird beispielsweise das Fahrzeug beschrieben. Aber auch eingesetzte Sensoren, Prozessoren etc. können hier jeweils ein Unterkapitel bekommen. Es ist darauf zu achten, dass hier nur der Vollständigkeit halber eine Beschreibung eingefügt wird. Dies soll einem Leser ermöglichen die Arbeit zu verstehen, der nicht hier an der WE arbeitet. Allerdings soll es nicht so ausarten, dass hier die komplette Dokumentation der einzelnen Bauteile abgeschrieben wird. In der Kürze liegt die Würze. Auch ist darauf zu achten, dass die Dokumentation, Herstellerwebseiten etc. als Quellen angegeben werden.

